<html lang="ko">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
  <title>Feed</title>
</head>

<body class="mx-auto" style="width:500px;">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
    crossorigin="anonymous"></script>

  <form id="form-input" class="d-flex flex-wrap mt-5" onsubmit="return false;">
    <textarea id="txt-post" class="form-control mb-1" placeholder="Leave a post here"></textarea>
    <input type="file" class="form-control me-1" accept="image/png, image/jpeg, video/mp4">
    <button id="btn-add" class="btn btn-primary" type="button">ADD</button>
  </form>
  <div id="div-list" class="mt-3">

  </div>
  <script>
    const formInput = document.querySelector("#form-input");
    const txtPost = document.querySelector("#txt-post");
    const fileInput = document.querySelector("input[type='file']");
    const btnAdd = document.querySelector("#btn-add");
    const divList = document.querySelector("#div-list");

    btnAdd.addEventListener("click", () => {

      console.log(fileInput.files[0]);
      const file = fileInput.files[0];

      let media = "";

      if (file) {
        const reader = new FileReader();
        reader.readAsDataURL(file);

        reader.onload = () => {
          // console.log(reader.result);
          const dataUrl = reader.result;

          // 이미지일 때와 비디오일 때 나눠서 처리
          if (file.type.includes("image")) {
            media = /*html*/`<img src=${dataUrl} class="card-img-top">`;
          } else {
            media = /*html*/`<video src=${dataUrl} class="card-img-top" controls></video>`
          }

          add();
        }
      } else {
        add();
      }

      function add() {
        const card = `
          <div class="card">
            ${media}
            <div class="card-body">
              <p class="card-text">${txtPost.value}</p>
              <a href="#" class="btn btn-outline-secondary btn-sm float-end remove">REMOVE</a>
            </div>
          </div>      
          `

        divList.insertAdjacentHTML("afterbegin", card);

        // 입력 폼 초기화
        formInput.reset();
      }
    })



  </script>
</body>

</html>